<div class="card">
    <div class="card-header header-title m-0" style="display: flex; justify-content: space-between;">
        <div>
            <i class="ri-file-list-fill m-2" style="font-size: 1.2rem;"></i>
            <strong style="font-size: 1.2rem;">
                Report</strong>
        </div>
        <button class="btn btn-outline-success" (click)="exportableToExcel()" *ngIf="tableData.length > 0"
        style="font-size: 15px!important; float:inline-end; padding-left: 1%; padding-right: 1%; padding-top: 7px; background-color: bisque; color:indianred">Export to Excel</button>
    </div>

    <div class="card-body ">
        <div class="row mb-3 align-items-center ">
            <div class="col-xxl-4">
                <div class="row">
                    <div class="col-12">
                        <label for="name" class="form-label">Select Project</label>
                        <select class="form-select" aria-label="Default select example" [(ngModel)]="ngDropDown">
                            <option selected disabled>Choose Project</option>
                            <option value="All">Show All</option>
                            <option *ngFor="let a of DropDownList" value="{{a.pCode}}">{{a.pName}}</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-xxl-4">
                <button type="button" class="btn btn-outline-success mx-2" style="margin-top: 25px;"                    
                    (click)="ClickDropDown()">View
                </button>
                <button type="button" class="btn btn-outline-secondary" style="margin-top: 25px;"                    
                (click)="open(content)">Filter Columns
            </button>
             
            </div>
            <div class="col-xxl-4 align-items-center" *ngIf="MasterQr != ''">
                <div class="column">
                    <div class="card Qrcard">
                        <label for="name" class="form-label">Master QrCode</label>
                        <qrcode String [qrdata]='MasterQr' [errorCorrectionLevel]="'M'" [width]="100"></qrcode>
                        <h4>{{MasterQrCodeId}}</h4>
                        <button type="button" class="btn btn-outline-success  " (click)="downloadAllQr()">Download
                            QR
                        </button>
                    </div>
                </div>
            </div>
        </div>    
        <mat-form-field class="mt-1 mb-2 searchbar">        
            <input matInput (keyup)="applyFilter($event)" placeholder="Search columns" class="form-control" >
        </mat-form-field>
        <div class="mat-elevation-z8" id="printContent" style="overflow-x: scroll;">
            <table mat-table [dataSource]="dataSource" matSort id="httptrace-table"
                class="table-responsive table-bordered table-striped table-hover">

                <ng-container matColumnDef="project">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Project </th>
                    <td mat-cell *matCellDef="let row"> {{row.app_Name}} </td>
                </ng-container>
                <ng-container matColumnDef="firstName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>FirstName </th>
                    <td mat-cell *matCellDef="let row"> {{row.first_Name || '--'}} </td>
                </ng-container>
                <ng-container matColumnDef="lastname">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>LastName </th>
                    <td mat-cell *matCellDef="let row"> {{row.last_name || '--'}} </td>
                </ng-container>

                <ng-container matColumnDef="enduserid">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> EndUserId </th>
                    <td mat-cell *matCellDef="let row"> {{row.end_Customer_ID||'--'}}</td>
                </ng-container>

                <ng-container matColumnDef="phone">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Phone </th>
                    <td mat-cell *matCellDef="let row"> {{row.phone || '--'}} </td>
                </ng-container>

                <ng-container matColumnDef="landline">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> LandLine </th>
                    <td mat-cell *matCellDef="let row"> {{row.landline || '--' }} </td>
                </ng-container>
                <ng-container matColumnDef="email">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Email </th>
                    <td mat-cell *matCellDef="let row"> {{row.email || '--' }} </td>
                </ng-container>
                <ng-container matColumnDef="username">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> User Name </th>
                    <td mat-cell *matCellDef="let row"> {{row.userName || '--' }} </td>
                </ng-container>
                <ng-container matColumnDef="password">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Password </th>
                    <td mat-cell *matCellDef="let row"> {{row.password || '--' }} </td>
                </ng-container>
                <ng-container matColumnDef="companyname">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> CompanyName </th>
                    <td mat-cell *matCellDef="let row"> {{row.company_Name || '--'}} </td>
                </ng-container>
                <ng-container matColumnDef="jobtitle">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> JobTitle </th>
                    <td mat-cell *matCellDef="let row"> {{row.job_Title || '--' }} </td>
                </ng-container>
                <ng-container matColumnDef="employeeid">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> EmployeeId </th>
                    <td mat-cell *matCellDef="let row"> {{row.emp_ID || '--' }} </td>
                </ng-container>
                <ng-container matColumnDef="department">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Department </th>
                    <td mat-cell *matCellDef="let row"> {{row.department || '--' }} </td>
                </ng-container>
                <ng-container matColumnDef="address">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Address </th>
                    <td mat-cell *matCellDef="let row"> {{row.address || '--' }} </td>
                </ng-container>
                <ng-container matColumnDef="summary">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Summary </th>
                    <td mat-cell *matCellDef="let row"> {{row.summary || '--' }} </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell text-center" colspan="20"><img src="assets/images/no_data_found.png" /></td>
                </tr>
                <tr class="mat-row text-center" *matNoDataRow>
                    <td class="mat-cell text-center" colspan="20">
                        <img src="assets/images/no_data_found.png" *ngIf="nodata" />
                    </td>
                </tr>
            </table>

            <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
        </div>
    </div>
</div>


<!--Filter column-->
<ng-template #content let-modal>
    <div class="modal-content ">
        <div class="modal-header">
            <h4>Filter Headers</h4>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="btn-close"
                (click)="modal.dismiss('Cross click')"></button>
        </div>
        <hr class="mx-0 mb-2 p-0 mb-2" style="border: 1px dashed" />
        <div class="modal-body">
            <div class="hstack flex-wrap gap-2 mb-3 mb-lg-0">
                <button class="btn btn-purple" *ngFor="let column of columnVisibilityKeys"
                    [class.active]="isColumnVisible(column)"
                    [ngStyle]="{'background': isColumnVisible(column) ? '#fadc0c' : '', 'color': isColumnVisible(column) ? '#000' : '#000', 'border': isColumnVisible(column) ? '#fadc0c ' : '1px solid #fadc0c '}"
                    (click)="toggleColumn(column)">
                    {{ column }}
                </button>
            </div>
        </div>
    </div>
</ng-template>